{
  "db_name": "PostgreSQL",
  "query": "MERGE INTO user_permission\n    USING (WITH input AS ( SELECT $1::bigint as id, $2::bigint as slf_id, $3::bool as self_change_password )\n        SELECT input.id, input.self_change_password FROM input\n            JOIN users ON users.id = input.id\n            JOIN flattened_web_domain_permissions perms ON perms.user_id = input.slf_id AND perms.domain_id = users.domain_id\n            JOIN flattened_domains domains ON users.domain_id = domains.id\n            WHERE slf_id = ANY(domains.domain_owner) OR perms.admin OR perms.modify_accounts\n    ) AS input ON user_permission.id = input.id\n    WHEN MATCHED THEN UPDATE SET self_change_password = input.self_change_password\n    WHEN NOT MATCHED THEN INSERT (id, self_change_password) VALUES (input.id, input.self_change_password)",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Int8",
        "Int8",
        "Bool"
      ]
    },
    "nullable": []
  },
  "hash": "4c0b112784e8b7a6d4ce4b863fffcadbeae1de85a231b9feaf40bc4f550e5b6f"
}
